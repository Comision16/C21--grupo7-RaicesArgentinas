<div class="table-responsive">
  <table class="table table-striped">
    <thead>
      <tr>
        <th scope="col">N°:</th>
        <th scope="col">Producto</th>
        <th scope="col">Categoría</th>
        <th scope="col">Caracteristica</th>
        <th scope="col">Region</th>
        <th scope="col">Cantidad</th>
        <th scope="col">Precio</th>
        <th scope="col">Decuento</th>
        <th scope="col">P. Final</th>
        <th scope="col">Acciones</th>
      </tr>
    </thead>
    <tbody>
      <% products.forEach(({id, title, category, section, region, amount,
      amountmin, price, discount, images, description}, index)=> { %>

      <tr>
        <th scope="row"><%= index + 1 %></th>
        <td><%= title %></td>
        <td><%= category.title %></td>
        <td><%= section.title %></td>
        <td><%= region.title %></td>
        <td><%= amount %></td>
        <td><%= price %></td>
        <td><%= discount %></td>
        <td><%= price - (price * discount / 100) %></td>
        <td>
          <div class="d-flex gap-1">
            <button
              type="button"
              class="btn btn-sm btn-primary"
              data-bs-toggle="modal"
              data-bs-target="#detailProduct<%=id%>"
            >
              <i class="fas fa-eye"></i>
            </button>

            <div
              class="modal fade"
              id="detailProduct<%=id%>"
              tabindex="-1"
              aria-labelledby="detailProduct<%=id%>Label"
              aria-hidden="true"
            >
              <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                  <div class="modal-header">
                    <h5 class="modal-title" id="detailProduct<%=id%>Label">
                      <%= title %>
                    </h5>
                    <button
                      type="button"
                      class="btn-close"
                      data-bs-dismiss="modal"
                      aria-label="Close"
                    ></button>
                  </div>
                  <div class="modal-body">
                    <div class="card mb-3" style="max-width: 540px">
                      <div class="row g-0">
                        <div class="col-md-6">
                          <img
                            src="/images/productos/<%= images.find(image => image.main).file %>"
                            class="img-fluid rounded-start"
                            alt="..."
                          />
                          <div class="d-flex flex-wrap justify-content-between mt-1">
                                                                <% images.filter(image => !image.main).forEach(image => { %>
                                                                    <img src="/img/products/<%= image.file %>"
                                                                    style="width: 33%;" alt="...">
                                                                <% }) %>
                                                            </div>
                        </div>
                        <div class="col-md-6">
                          <div class="card-body">
                            <h5 class="card-title"><%=title%></h5>
                            <p class="card-text"><%=description%></p>
                            <ul class="list-group list-group-flush">
                              <li class="list-group-item">
                                <b>Categoria </b><%= category.title %>
                              </li>
                              <li class="list-group-item">
                                <b>Seccion </b><%= section.title %>
                              </li>
                              <li class="list-group-item">
                                <b>Region </b><%= region.title %>
                              </li>
                              <li class="list-group-item">
                                <b>Precio </b><%= price %>
                              </li>
                              <li class="list-group-item">
                                <b>Descuento </b><%= discount %>
                              </li>
                            </ul>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="modal-footer">
                    <button
                      type="button"
                      class="btn btn-secondary"
                      data-bs-dismiss="modal"
                    >
                      Cerrar
                    </button>
                  </div>
                </div>
              </div>
            </div>
            <a class="btn btn-sm btn-success" href="/products/edit/<%= id %>"
              ><i class="fas fa-edit"></i
            ></a>

            <!-- Button trigger modal -->
            <button
              type="button"
              class="btn btn-sm btn-danger"
              data-bs-toggle="modal"
              data-bs-target="#removeProduct<%= id %>"
            >
              <i class="fas fa-trash"></i>
            </button>

            <!-- Modal -->
            <div
              class="modal fade"
              id="removeProduct<%= id %>"
              tabindex="-1"
              aria-labelledby="removeProduct<%= id %>Label"
              aria-hidden="true"
            >
              <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                  <div class="modal-header">
                    <h1
                      class="modal-title fs-5"
                      id="removeProduct<%= id %>Label"
                    >
                      ADVERTENCIA
                    </h1>
                    <button
                      type="button"
                      class="btn-close"
                      data-bs-dismiss="modal"
                      aria-label="Close"
                    ></button>
                  </div>
                  <div class="modal-body">
                    <p>
                      Estás seguro que querés eliminar el producto
                      <b> <%= title %> </b>
                    </p>
                  </div>
                  <div class="modal-footer">
                    <button
                      type="button"
                      class="btn btn-secondary"
                      data-bs-dismiss="modal"
                    >
                      Cancelar
                    </button>
                    <form
                      action="/products/remove/<%= id %>?_method=DELETE"
                      method="POST"
                    >
                      <button type="submit" class="btn btn-danger">
                        Eliminalo
                      </button>
                    </form>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </td>
      </tr>
      <% }) %>
    </tbody>
  </table>
</div>
